#include <math.h>#include <stdio.h>#include <string.h> #include <time.h>#define R2_IM1 2147483563#define R2_IM2 2147483399#define unlikely -214741#define R2_AM (1.0/R2_IM1)#define R2_IMM1 (R2_IM1-1)#define R2_IA1 40014#define R2_IA2 40692#define R2_IQ1 53668#define R2_IQ2 52774#define R2_IR1 12211#define R2_IR2 3791#define R2_NTAB 32#define R2_NDIV (1+R2_IMM1/R2_NTAB)#define R2_EPS 1.2e-7#define R2_RNMX (1.0-R2_EPS)long seed;void srand4(void) {	seed=(long)time(NULL);}void srand5(int rank) {	seed=(long)(rank);}double ran2(long *idum) {	int j;	long k;	static long idum2=123456789;	static long iy=0;	static long iv[R2_NTAB];	double temp;	if(*idum<=0 || !iy){		if(-(*idum)<1) *idum=1*(*idum);		else *idum=-(*idum);		idum2=(*idum);		for(j=R2_NTAB+7;j>=0;j--){			k=(*idum)/R2_IQ1;			*idum=R2_IA1*(*idum-k*R2_IQ1)-k*R2_IR1;			if(*idum<0) *idum+=R2_IM1;			if(j<R2_NTAB) iv[j]=*idum;		}		iy=iv[0];	}	k=(*idum)/R2_IQ1;	*idum=R2_IA1*(*idum-k*R2_IQ1)-k*R2_IR1;	if(*idum<0) *idum+=R2_IM1;	k=(idum2)/R2_IQ2;	idum2=R2_IA2*(idum2-k*R2_IQ2)-k*R2_IR2;	if (idum2 < 0) idum2 += R2_IM2;	j=iy/R2_NDIV;	iy=iv[j]-idum2;	iv[j]=*idum;	if(iy<1) iy+=R2_IMM1;	if((temp=R2_AM*iy)>R2_RNMX) return R2_RNMX;	else return temp;}double ran4(void) {	double r;		r=ran2(&seed);	return(r);}int irand(int n) {					// returns an integer number from 0 to n	return (int(ran4()*(n+1)));}